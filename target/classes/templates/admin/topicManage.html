<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Material Design Bootstrap</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!-- Material Design Bootstrap -->
    <link rel="stylesheet" th:href="@{/css/mdb.min.css}">
    <!-- Your custom styles (optional) -->

    <style>
        /* Only for snippet */
        .double-nav .breadcrumb-dn {
            color: #fff;
        }

        .button-collapse i {
            color: #fff
        }
    </style>
</head>


<body class="fixed-sn black-skin">

<!--Main Navigation-->
<header>

    <th:block th:include="/admin/_menu"></th:block>

</header>
<!--Main Navigation-->

<!--Main Layout-->
<main class="p-0">
    <div class="container-fluid mb-5">
        <section>
            <div class="card my-2">
                <div class="card-body">
                    <div class="row">

                        <div class="col-sm">
                            <H3 class="my-auto float-left">List topic</H3>
                        </div>
                        <div class="col-sm">
                            <button class="btn btn-success float-right" data-toggle="modal" data-target="#modalAdd"
                                    id="addUser">
                                New
                                topic
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Section: Basic examples -->
        <section>

            <div class="my-3"></div>

            <div class="card">

                <div class="card-body">
                    <div class="card-title h3">Chúng tôi</div>
                    <div class="table-responsive">
                        <!-- Table -->
                        <table class="table">

                            <!-- Table head -->
                            <thead class="mdb-color darken-3">
                            <tr class="text-white">
                                <th>#</th>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Meta title</th>
                                <th>Detail</th>
                                <th>Title parent</th>
                                <th>Action</th>
                            </tr>
                            </thead>
                            <!-- Table head -->

                            <!-- Table body -->
                            <tbody id="dataCategory">

                            <tr>
                                <th scope="row">1</th>
                                <td>ID</td>
                                <td>Title</td>
                                <td>Meta title</td>
                                <td>Detail</td>
                                <td>ID parent</td>
                                <td>Title parent</td>
                            </tr>

                            </tbody>
                            <!-- Table body -->
                        </table>
                        <!-- Table -->
                    </div>


                </div>
            </div>

        </section>
        <!-- Section: Basic examples -->
        <!-- Section: Basic examples -->
        <section>

            <div class="my-3"></div>

            <div class="card">

                <div class="card-body">
                    <div class="card-title h3">Hoạt dộng</div>
                    <div class="table-responsive">
                        <!-- Table -->
                        <table class="table">

                            <!-- Table head -->
                            <thead class="mdb-color darken-3">
                            <tr class="text-white">
                                <th>#</th>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Meta title</th>
                                <th>Detail</th>
                                <th>Title parent</th>
                                <th>Action</th>
                            </tr>
                            </thead>
                            <!-- Table head -->

                            <!-- Table body -->
                            <tbody id="dataCategory2">

                            <tr>
                                <th scope="row">1</th>
                                <td>ID</td>
                                <td>Title</td>
                                <td>Meta title</td>
                                <td>Detail</td>
                                <td>ID parent</td>
                                <td>Title parent</td>
                            </tr>

                            </tbody>
                            <!-- Table body -->
                        </table>
                        <!-- Table -->
                    </div>


                </div>
            </div>

        </section>
        <!-- Section: Basic examples -->
    </div>


</main>
<!--Main Layout-->

</body>

<!-- SCRIPTS -->
<!-- JQuery -->
<script th:src="@{/js/jquery-3.4.1.min.js}"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" th:src="@{/js/popper.min.js}"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" th:src="@{/js/bootstrap.js}"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" th:src="@{/js/mdb.min.js}"></script>
<script type="text/javascript" th:src="@{/js/addons/datatables.min.js}"></script>
<script type="text/javascript" th:src="@{/js/addons/datatables-select.min.js}"></script>
<!-- Custom scripts -->
<script>
    $(document).ready(function () {
        $(".button-collapse").sideNav();
        new WOW().init();
        // Material Design example
        $('#tblUser').DataTable({
            "pagingType": "full_numbers"
        });
        $('body').ready(fillCategoryChungToi(), fillCategoryHoatDong());
        $(document).on('click', 'option.enterChungToi', function () {
            console.log("run - enterChungToi");
            var id = $(this).val();
            $.ajax({
                url: 'http://localhost:8080/api/getlistCategory/' + id,
                type: 'POST',
                dataType: 'JSON',
                processData: false,
                beforeSend: function(){
                    $('#dataCategory').html('<span class="spinner-border spinner-border-sm mr-2 text-center" role="status" aria-hidden="true"></span>Loading...');
                },
                success: function (value) {
                    listCategoryChungToi = value;

                },
                complete: function () {
                    fillToTableChungToi();
                }
            });
        });
        $(document).on('click', 'option.enterHoatDong', function () {
            console.log("run - enterHoatDong");
            var id = $(this).val();
            $.ajax({
                url: 'http://localhost:8080/api/getlistCategory/' + id,
                type: 'POST',
                dataType: 'JSON',
                processData: false,
                beforeSend: function(){
                    $('#dataCategory2').html('<span class="spinner-border spinner-border-sm mr-2 text-center" role="status" aria-hidden="true"></span>Loading...');
                },
                success: function (value) {
                    listCategoryHoatDong = value;

                },
                complete: function () {
                    fillToTableHoatDong();
                }
            });

        });

        var listCategoryChungToi = {};
        var listCategoryHoatDong = {};

        function fillCategoryChungToi() {
            $.ajax({
                url: 'http://localhost:8080/api/getlistCategory/chungtoi',
                type: 'POST',
                dataType: 'JSON',
                processData: false,
                beforeSend: function(){
                    $('#dataCategory').html('<span class="spinner-border spinner-border-sm mr-2 text-center" role="status" aria-hidden="true"></span>Loading...');
                },
                success: function (data) {
                    listCategoryChungToi = data;
                },
                complete: function () {
                    fillToTableChungToi();
                }
            })
        }

        function fillCategoryHoatDong() {
            $.ajax({
                url: 'http://localhost:8080/api/getlistCategory/hoatdong',
                type: 'POST',
                dataType: 'JSON',
                processData: false,
                beforeSend: function(){
                    $('#dataCategory2').html('<span class="spinner-border spinner-border-sm mr-2 text-center" role="status" aria-hidden="true"></span>Loading...');
                },
                success: function (data) {
                    listCategoryHoatDong = data;
                },
                complete: function () {
                    fillToTableHoatDong();
                }
            })
        };

        function fillToTableHoatDong() {
            var htmlContent = '';
            for (var i = 0; i < listCategoryHoatDong.length; i++) {
                htmlContent +=
                    '<tr class="wow fadeIn"  data-wow-delay="0.6s">' +
                    '<th class="p-4" scope="row">' + (i + 1) + '</th>' +
                    '<td class="p-4">' + listCategoryHoatDong[i].id + '</td>' +
                    '<td class="p-4">' + listCategoryHoatDong[i].title + '</td>' +
                    '<td class="p-4">' + listCategoryHoatDong[i].metatitle + '</td>' +
                    '<td class="p-4">' + listCategoryHoatDong[i].detail + '</td>' +
                    '<td class="p-4">' + listCategoryHoatDong[i].parentTitle + '</td>' +
                    '<td>'+addOptionBack(listCategoryHoatDong[i].hasParent,listCategoryHoatDong[i].idParent,'HoatDong')+'<option class="btn btn-default btn-sm">Edit</option>'+addOptionNext(listCategoryHoatDong[i].hasChild,listCategoryHoatDong[i].id,'HoatDong')+'</td>' +
                    '</tr>'
            }

            $('#dataCategory2').html(htmlContent);
        };

        function fillToTableChungToi() {
            var htmlContent = '';
            for (var i = 0; i < listCategoryChungToi.length; i++) {
                htmlContent +=
                    '<tr class="wow fadeIn"  data-wow-delay="0.6s">' +
                    '<th class="p-4" scope="row">' + (i + 1) + '</th>' +
                    '<td class="p-4">' + listCategoryChungToi[i].id + '</td>' +
                    '<td class="p-4">' + listCategoryChungToi[i].title + '</td>' +
                    '<td class="p-4">' + listCategoryChungToi[i].metatitle + '</td>' +
                    '<td class="p-4">' + listCategoryChungToi[i].detail + '</td>' +
                    '<td class="p-4">' + listCategoryChungToi[i].parentTitle + '</td>' +
                    '<td>'+addOptionBack(listCategoryChungToi[i].hasParent,listCategoryChungToi[i].idParent,'ChungToi')+'<option class="btn btn-default btn-sm">Edit</option>'+addOptionNext(listCategoryChungToi[i].hasChild,listCategoryChungToi[i].id,'ChungToi')+'</td>' +
                    '</tr>'
            }

            $('#dataCategory').html(htmlContent);
        };

        function addOptionNext(haschild,value,enter) {
            if(haschild){
                return '<option value="' + value + '" class="btn btn-default btn-sm enter'+enter+'"> >> </option>';
            }else {
                return '';
            }
        };

        function addOptionBack(hasparent,value,enter) {
            if(hasparent){
                return '<option value="' + value + '" class="btn btn-default btn-sm enter'+enter+'"> << </option>';
            }else {
                return '';
            }
        };


        $('#loading-image').bind('ajaxStart', function(){
            $(this).hide();
        }).bind('ajaxStop', function(){
            $(this).show();
        });
    });
</script>

</html>